Result Size: 682 x 540
-
    const name=s.querySelector("input[type=text]").value||"Subject";
    let ext=parseInt(s.querySelectorAll("input")[1].value)||0;
    let inte=parseInt(s.querySelectorAll("input")[2].value)||0;
    const type=s.querySelector("select").value;
​
    let total=ext+inte, passed=false, graceGiven=0, remarks="", originalExt=ext;
    let need=0;
​
    if(type==="theory"){
  if(ext>=25 && total>=33){ passed=true; passCount++; }
  else {
    need=Math.max(25-ext,33-total);
    if(need>0 && need<=5){ ext+=need; total+=need; graceGiven=need; }
  }
  if(!passed) remarks=`Fail: Need ${need} more marks in External/Total`;
​
} else if(type==="practical"){
  // practical same rule as theory but NO grace
  if(ext>=25 && total>=33){ passed=true; passCount++; }
  else { remarks="Fail: Practical needs 25 External & 33 Total"; }
​
} else if(type==="cocurricular"){
  if(total>=40){ passed=true; passCount++; }
  else {
    need=40-total;
    if(need>0 && need<=5){ ext+=need; total+=need; graceGiven=need; }
  }
  if(!passed) remarks=`Fail: Need ${need} more marks in Co-Curricular`;
​
} else { // project/skill
  if(total>=40){ passed=true; passCount++; }
  else { remarks="Fail: Total <40"; }
}
​
    if(graceGiven>0){ totalGrace+=graceGiven; subjectsUsed++; if(ext>=25 && total>=33 && type!=="cocurricular") passed=true; if(type==="cocurricular" && total>=40) passed=true; if(passed) passCount++; }
    if(!passed) failCount++;
​
    subjectsData.push({name,ext,inte,total,passed,graceGiven,remarks,originalExt});
  });
​
  // Grace rule check: cancel if >5 total or >2 subjects
  if(totalGrace>5 || subjectsUsed>2){
    subjectsData.forEach(sd=>{
      if(sd.graceGiven>0){
        sd.ext=sd.originalExt;
        sd.total=sd.originalExt+sd.inte;
        sd.passed=false;
        sd.remarks=`Grace Cancelled (Not Eligible). Need ${Math.max(25-sd.originalExt,33-sd.total)} more marks in External`;
        sd.graceGiven="-";
